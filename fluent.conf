<source>
  @type  forward
  port  24224
  @label @mainstream
</source>

<filter **>
  @type stdout
</filter>


<label @FLUENT_LOG>
    <match **>
        @type stdout
    </match>
</label>

<label @mainstream>
    <match **>
        @type stdout
    </match>
    <match **>
        @type postgres
        @id sql
        host "#{ENV['fluent_host']}"
        port "#{ENV['fluent_port']}"
        database "#{ENV['fluent_database']}"
        username "#{ENV['fluent_username']}"
        password "#{ENV['fluent_password']}"


        key_names msg, caller, level, STAGE, logger, SPRING_APPLICATION_NAME, thread, message
        sql INSERT INTO monitoring.log (msg, caller, level, STAGE, logger, SPRING_APPLICATION_NAME, thread, message) VALUES ($1,$2,$3,$4,$5,$6,$7,$8)
    </match>
</label>